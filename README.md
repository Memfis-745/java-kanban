# java-kanban
# Трекер задач.

Использованные технологии: Java, JUnit, GSON, RESTful API

Данное приложение позволяет систематизировать список задач. При этом, каждая задача (task) может иметь один из статусов в зависимости от степени реализации:
Новая задача (new), выполняемая (in progress) и выполненная (done).

Кроме того, каждая задача, может иметь одну или несколько подзадач (subtask). Задача с подзадачей, является эпиком (epic). Статус выполнения задачи или эпика зависит от статуса выполнения ее подзадач.

### Свойства задач:
Задачи, как и эпики и подзадачи обладают именем - name, описанием - description, длительностью – duration, стартом - startTime и финишем - finishTime, а также уникальным идентификатором. Две задачи (task) или задача и эпик(epic) не могут осуществляться в одно и то же время. Продолжительность эпика равняется сумме продолжительностей его подзадач (subtask).

### В приложении реализованы следующие функции:

- Сохранение задачи в памяти приложения.
- Сохранение задачи в файле.
- Получение списков задач, подзадач и эпиков.
- Удаление всех задач, подзадач и эпиков.
- Получение задачи, подзадачи или эпика по id.
- Изменение статуса задач.
- Удаление задачи по id.
- Отслеживание и сохранение истории изменений задач.
- Просмотр истории изменений.
- Получение и отправка задач через RESTful API.

Приложение может работать как в режиме приложения с возможностью подключения интерфейса ввода-вывода данных, так и в качестве сервера запущенного на порту 8080.

Класс TaskManager является интерфейсом, для классов-менеджеров задач, реализующих указанные функции: InMemoryTaskManager и FileBackedTaskManager.

#### InMemoryTaskManager. 
Это основной класс, содержащий методы для обработки задач и сохраняющий их в hash-map. Основные функции менеджера, реализованные для задач, подзадач и эпиков. Для краткости – задач.

1.	Сохранение. Приложение принимает объект в качестве параметра и сохраняет его в hash-map.
2.	Обновление. Приложение принимает объект с идентификатором и обновляет его в hash-map.
3.	Приложение принимает изменившийся статус задачи и меняет его с new на in progress и после на done. Последнее касается непосредственно задач. Для эпиков, меняется статус только подзадач, и на его основании меняется статус эписка. Если у двух подзадач статус – done, то и у эпика статус автоматически становится done.
4.	Получение списка задач.
5.	Удаление всех задач.
6.	Получение задачи по идентификатору и сохранение просмотренных задач в истории.
7.	Удаление задачи по идентификатору.
8.	Получение списка подзадач, конкретного эпика.

#### FileBackedTaskManager 
расширяет InMemoryTaskManager и реализует интерфейс TaskManager. Он отвечает за сохранение и загрузку данных задач из файла. В отличие от InMemoryTaskManager, который хранит данные только в памяти, этот класс использует файл для сохранения данных, что позволяет сохранять данные между запусками программы.

Дополнительно, FileBackedTaskManager предоставляет функциональность для:

-  Сохранения данных о задачах, эпиках и подзадачах в файл.
-  Загрузки данных из файла и восстановления состояния менеджера задач.
-  Управления задачами в памяти, используя унаследованную функциональность от InMemoryTaskManager.

Конструктор FileBackedTaskManager (File file): Принимает объект File в качестве аргумента, указывая файл, который будет использоваться для хранения данных.
save() - метод, для записи файла. 

##### save() 
В методе перебираются все hash-map, соответствующие задачам подзадачам и эпикам: listOfTask, listOfEpic и listOfSubTask. Объект преобразовывается в строку и записывается в файл в виде:

-  Task: id,type,name,status,description,duration,startTime
- Epic: id,type,name,status,description
-  Subtask: id,type,name,status,description,epicId,duration,startTime

##### loadFromFile(File file):
Статический метод, который построчно загружает данные из файла и создает новый объект FileBackedTaskManager с восстановленными данными. На основе типа задачи создает соответствующие объекты (Task, Epic или Subtask) и добавляет их в соответствующие коллекции (listOfTask, listOfEpic и listOfSubTask). Для подзадач устанавливает связь с эпиком и обновляет время начала и продолжительность эпика.

### Сервер запускается с помощью класса HttpTaskServer.

#### HttpTaskServer 
является HTTP-сервером, который предоставляет RESTful API для управления задачами. Он использует TaskManager для хранения и обработки задач, Gson для преобразования данных в JSON и HttpServer для обработки HTTP-запросов. В методе main класса HttpTaskServer может быть создан экземпляр FileBackedTaskManager, для сохранения запросов в отдельный файл или экземпляр InMemoryTaskManager, для хранения данных запроса в памяти. В данном случае реализован второй вариант. При этом, экземпляр FileBackedTaskManager можно создать запустив приложение через основной метод main.

#### BaseHttpHandler
Абстрактный базовый класс для обработки HTTP-запросов. Это шаблон, позволяющий организовать обработку HTTP-запросов к TaskManager. Он предоставляет общую структуру и логику для обработки GET, POST и DELETE запросов, а также базовые методы для отправки ответов клиенту.

Классы-наследники: 'TaskHandler', EpicHandler и SubtaskHandler специфические для разных типов задач (Task, Epic, Subtask) переопределяют методы get, create, update, delete для реализации конкретной логики.

#### HystoryHandler и PrioretizeHandler, 
позволяют обратиться к истории просмотров и к списку задач выстроенному по приоритету времени начала. Когда приходит HTTP-запрос, HttpTaskServer вызывает метод handle соответствующего обработчика, в зависимости от эндпойнта. Handle анализирует запрос (метод, путь, тело) и вызывает один из process-методов. Process-методы вызывают методы taskManager для выполнения операций с задачами. Результаты сериализуются в JSON с помощью gson и отправляются обратно клиенту с помощью sendText.

Классы LocalDateTimeAdapter и DurationAdapter – отвечают за преобразование объектов соответственно LocalDateTime и Duration в JSON-представление и обратно.

#### Managers
класс, который содержит статические методы для получения экземпляров основных компонентов системы управления задачами.
- getDefault(): Создает и возвращает новый экземпляр класса InMemoryTaskManager. Данная реализация предполагает, что задачи хранятся в памяти в хэш-таблицах.
- getDefaultHistory(): Создает и возвращает новый экземпляр класса InMemoryHistoryManager. Этот класс также хранит историю в памяти.
- getGson(): Создает GsonBuilder сконфигурированный экземпляр Gson, для сериализации и десериализации объектов с использованием классов LocalDateTimeAdapter и DurationAdapter.

#### InMemoryHistoryManager 
сохраняет историю последних операций в двусвязном hash-map и реализует функции добавления операции, получения и удаления элемента истории по id. Ключом является id задачи, а значением узел связного списка, содержащий предыдущий и следующий элементы. В историю добавляются задачи для которых вызывались методы showTask(), showEpic и showSubTask. Если задача просматривалась несколько раз – в историю попадет последний просмотр, на последнее место в очереди.

### Тесты.

Тесты охватывают классы TaskManager: тестами охвачены все методы классов InMemoryTaskManager и FileBackedTaskManager. Кроме того, проверяется работа с пустым списком задач, неверными или пустым идентификаторами. Дополнительно для  FileBackedTaskManager, проверяется запись и чтение из файла пустого списка, эпика без подзадач. Для InMemoryHistoryManager проверяются граничные условия – пустая история задач, дублирование, удаление из истории. HttpTaskServer – проверяется отправка, восстановление данных и ответ сервера. Managers – на формирование InMemoryTaskManager.

